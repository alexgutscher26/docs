---
title: 'Environment Variables'
description: 'Set up and manage your StackForge production environment variables'
---

# Environment Variables

Properly configuring environment variables is essential for a secure and functional production deployment of your StackForge application. This guide covers all the environment variables you need to set up for production.

## Required Environment Variables

These environment variables are required for your StackForge application to function in production:

```env
# App Configuration
NEXT_PUBLIC_APP_NAME=YourAppName
NEXT_PUBLIC_APP_DOMAIN=https://yourdomain.com

# Database
DATABASE_URL=postgresql://user:password@host:port/database

# Clerk Authentication
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_live_XXXXXXXXXXXXXXXXXXXXXXXX
CLERK_SECRET_KEY=sk_live_XXXXXXXXXXXXXXXXXXXXXXXX
NEXT_PUBLIC_CLERK_SIGN_IN_URL=/auth/signin
NEXT_PUBLIC_CLERK_SIGN_UP_URL=/auth/signup
NEXT_PUBLIC_CLERK_SIGN_IN_FALLBACK_URL=/
NEXT_PUBLIC_CLERK_SIGN_UP_FALLBACK_URL=/
```

## Optional Environment Variables

These environment variables enhance functionality but are not required:

```env
# Email Service Configuration
RESEND_API_KEY=your_resend_api_key

# Analytics and Monitoring
NEXT_PUBLIC_VERCEL_ANALYTICS_ID=your_vercel_analytics_id
NEXT_PUBLIC_POSTHOG_KEY=your_posthog_key
NEXT_PUBLIC_POSTHOG_HOST=https://app.posthog.com

# Feature Flags
NEXT_PUBLIC_ENABLE_DARK_MODE=true
NEXT_PUBLIC_ENABLE_ANALYTICS=true
NEXT_PUBLIC_MAINTENANCE_MODE=false

# Performance Optimization
NEXT_PUBLIC_ENABLE_CACHE=true
NEXT_PUBLIC_CACHE_DURATION=3600
```

## Security Best Practices

### Secret Management

1. **Never commit secrets** to version control
2. **Use platform-specific secret management** (Vercel, Cloudflare, etc.)
3. **Rotate secrets regularly** for enhanced security
4. **Limit permissions** for API keys

### Environment-Specific Configuration

### Production Environment

For production deployments, set these environment variables in your hosting platform:

```env
# Production Environment
NODE_ENV=production
NEXT_PUBLIC_APP_NAME=YourAppName
NEXT_PUBLIC_APP_DOMAIN=https://yourdomain.com
DATABASE_URL=postgresql://user:password@host:port/database
```

### Staging Environment

For staging environments, you might want to use different settings:

```env
# Staging Environment
NODE_ENV=production
NEXT_PUBLIC_APP_NAME=YourApp Staging
NEXT_PUBLIC_APP_DOMAIN=https://staging.yourdomain.com
DATABASE_URL=postgresql://user:password@host:port/database_staging
```

## Platform-Specific Configuration

### Vercel

To configure environment variables in Vercel:

1. Go to your project settings in the Vercel dashboard
2. Navigate to "Environment Variables"
3. Add each environment variable with the appropriate value
4. Set the environment to "Production" for production variables

### Cloudflare Pages

To configure environment variables in Cloudflare Pages:

1. Go to your project settings in the Cloudflare dashboard
2. Navigate to "Settings" > "Environment variables"
3. Add each environment variable with the appropriate value

### Docker

To configure environment variables with Docker:

```dockerfile
# Dockerfile
FROM node:18-alpine AS base

# Install dependencies
WORKDIR /app
COPY package.json bun.lock ./
RUN bun install --production

# Copy source code
COPY . .

# Build the application
RUN bun run build

# Production stage
FROM node:18-alpine AS production

WORKDIR /app

# Copy built application
COPY --from=base /app/.next ./.next
COPY --from=base /app/node_modules ./node_modules
COPY --from=base /app/package.json ./package.json

# Set environment variables
ENV NODE_ENV=production
ENV NEXT_PUBLIC_APP_NAME=YourAppName
ENV NEXT_PUBLIC_APP_DOMAIN=https://yourdomain.com

# Expose port
EXPOSE 3000

# Start the application
CMD ["bun", "run", "start"]
```

Or use an env file:

```bash
# .env.production
NEXT_PUBLIC_APP_NAME=YourAppName
NEXT_PUBLIC_APP_DOMAIN=https://yourdomain.com
DATABASE_URL=postgresql://user:password@host:port/database
```

## Environment Variable Validation

StackForge includes built-in validation for environment variables. You can validate your production environment variables using:

```bash
bun run env:validate
```

This script checks that all required environment variables are present and properly formatted.

### Custom Validation

To add custom validation for your environment variables, modify the validation schema in `scripts/validate-env.ts`:

```ts
// scripts/validate-env.ts
import { z } from 'zod';

const envSchema = z.object({
  // Required variables
  NEXT_PUBLIC_APP_NAME: z.string().min(1),
  NEXT_PUBLIC_APP_DOMAIN: z.string().url(),
  DATABASE_URL: z.string().url(),
  NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY: z.string().min(1),
  CLERK_SECRET_KEY: z.string().min(1),
  
  // Optional variables with defaults
  NEXT_PUBLIC_ENABLE_DARK_MODE: z
    .string()
    .optional()
    .default('false')
    .transform((val) => val === 'true'),
});

export const env = envSchema.parse(process.env);
```

## Managing Sensitive Data

### Database Credentials

Never expose database credentials in client-side code. Always use the `DATABASE_URL` environment variable on the server side only.

### API Keys

Store API keys securely and never expose them in client-side code:

```ts
// Correct - Server-side only
export async function sendEmail() {
  const apiKey = process.env['RESEND_API_KEY'];
  // ... send email
}

// Incorrect - Exposes key to client
const apiKey = process.env['NEXT_PUBLIC_RESEND_API_KEY']; // DON'T DO THIS
```

## Environment Variable Encryption

For highly sensitive data, consider using environment variable encryption:

### Using Vercel Encryption

Vercel provides encrypted environment variables:

1. In the Vercel dashboard, enable "Encrypt environment variables"
2. Vercel automatically encrypts all environment variables
3. Access them normally in your application

### Custom Encryption

For custom encryption solutions:

```ts
// lib/encryption.ts
import crypto from 'crypto';

const algorithm = 'aes-256-cbc';
const secretKey = process.env['ENCRYPTION_KEY'];

export function decrypt(encryptedData: string): string {
  const decipher = crypto.createDecipher(algorithm, secretKey);
  let decrypted = decipher.update(encryptedData, 'hex', 'utf8');
  decrypted += decipher.final('utf8');
  return decrypted;
}
```

## Troubleshooting

### Common Issues

1. **Missing Variables**: Ensure all required variables are set
2. **Invalid Format**: Check that URLs and keys are properly formatted
3. **Permission Issues**: Verify API keys have correct permissions
4. **Environment Mismatch**: Confirm you're using the right environment

### Debugging Environment Variables

To debug environment variables in production:

1. **Check platform logs** for environment variable loading
2. **Add logging** to verify variables are loaded correctly
3. **Use validation scripts** to check variable integrity
4. **Test in staging** before deploying to production

### Environment Variable Testing

Create a test endpoint to verify environment variables:

```ts
// src/app/api/debug/route.ts
import { NextResponse } from 'next/server';

export async function GET() {
  return NextResponse.json({
    appName: process.env['NEXT_PUBLIC_APP_NAME'],
    domain: process.env['NEXT_PUBLIC_APP_DOMAIN'],
    clerkConfigured: !!process.env['NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY'],
    databaseConfigured: !!process.env['DATABASE_URL'],
  });
}
```

## Next Steps

<CardGroup cols={2}>

<Card
  title="Deployment Options"
  icon="cloud-arrow-up"
  href="/going-to-production/deployment-options"
>
  Choose the right deployment platform
</Card>

<Card
  title="Database Setup"
  icon="database"
  href="/going-to-production/database-setup"
>
  Configure your production database
</Card>

</CardGroup>